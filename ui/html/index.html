<!doctype html>
<html lang="en">
  <head>
    <title>Tasks</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="A Todo App for Urbit" />
    <meta name="view-transition" content="same-origin" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-title" content="Maat" />
    <meta
      name="apple-mobile-web-app-status-bar-style"
      content="black-translucent"
    />
    <link rel="apple-touch-icon" href="/apps/maat/icon180.png" />
    <link rel="icon" href="/apps/maat/icon16.png" sizes="16x16" />
    <link
      rel="icon"
      href="/apps/maat/icon.svg"
      sizes="any"
      type="image/svg+xml"
    />
    <link
      rel="manifest"
      href="/apps/maat/manifest.json"
      crossorigin="use-credentials"
    />
    <link rel="stylesheet" href="/apps/maat/udjat.css" />
    <link rel="stylesheet" href="/apps/maat/style.css" />
    <link rel="preconnect" href="https://rsms.me/" />
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />
    <script src="/apps/maat/index.js"></script>
    <script src="/apps/maat/path-deps.js"></script>
    <script src="/apps/maat/json-enc.js"></script>
    <script src="/apps/maat/client-side-templates.js"></script>
    <script src="https://unpkg.com/htmx.org@1.9.12/dist/ext/debug.js"></script>
  </head>

  <body hx-boost="true" hx-ext="client-side-templates,path-deps">
    <header>
      <div id="error-div" class="error">
        <pre hidden id="error-pre"></pre>
      </div>
    </header>
    <div id="overlay" class="overlay htmx-indicator htmx-request">
      <img class="spinner" src="/apps/maat/circles.svg" />
    </div>
    <div class="with-sidebar">
      <div hx-indicator="#overlay"><!-- sidebar -->
<nav>
  <div class="header-icon">
    <h2><img class="svg-ico" src="/apps/maat/icon.svg" />MAAT</h2>
  </div>
  <ul
    id="lists"
    hx-get="/api/lists"
    hx-trigger="load, path-deps"
    path-deps="/apps/maat/api/lists"
    mustache-template="lists-template"
  ></ul>
  <template id="lists-template">
    <!-- iterate over array of response object -->
    {{#.}}
    <li>
      <a href="/lists/{{gid}}/tasks#filter-tasks">{{title}}</a>
    </li>
    {{/.}}
  </template>
  <ul class="sticky-bottom">
    <li>
      <a>
        <form
          id="put-lists"
          class="inline-form"
          hx-put="/api/lists"
          hx-ext="json-enc"
          hx-swap="none"
          hx-vals="js:{gid: self.crypto.randomUUID(), public: false}"
          hx-on::after-request="if(event.detail.successful) this.reset();"
        >
          <input
            class="inline-input"
            name="title"
            type="text"
            placeholder="Add new list"
            autocomplete="false"
            spellcheck="false"
            required
          />
        </form>
      </a>
    </li>
    <li><a href="/lists/{gid}/settings">Settings</a></li>
  </ul>
</nav>
</div>
      <div><div id="main">
  <!-- non-sidebar -->
  <!-- <datalist id="tags"> -->
  <!--   <option>#hastag</option> -->
  <!--   <option>#tag</option> -->
  <!-- </datalist> -->
  <!--   <form method="get" action="#"> -->
  <!--     <fieldset> -->
  <!--       <input -->
  <!--         list="tags" -->
  <!--         name="task" -->
  <!--         type="text" -->
  <!--         id="task" -->
  <!--         autocomplete="off" -->
  <!--         placeholder="Filter by tags" -->
  <!--       /> -->
  <!--     </fieldset> -->
  <!--   </form> -->

  <h2
    id="list"
    hx-get="/api/lists/{gid}"
    hx-trigger="load, path-deps"
    path-deps="/apps/maat/api/lists/*/tasks"
    mustache-template="list-template"
  ></h2>
  <template id="list-template"
    >{{title}}<img
      style="visibility: hidden"
      class="svg-ico"
      src="/apps/maat/icon.svg"
  /></template>
  <ul class="sticky-top" id="filter-tasks">
    <li>
      <a class="icon icon-circle-question"></a>
      <form id="filter-tasks" class="inline-form">
        <input class="inline-input" placeholder="Filter by tags" />
      </form>
    </li>
  </ul>
  <ul
    id="tasks-todo"
    hx-get="/api/lists/{gid}/tasks"
    hx-vals='{"done": "false"}'
    hx-trigger="load, path-deps"
    path-deps="/apps/maat/api/lists/*/tasks"
    mustache-template="tasks-todo-template"
  ></ul>
  <template id="tasks-todo-template">
    {{#.}}
    <li>
      <a
        id="{{tid}}"
        class="icon icon-circle"
        hx-put="/api/lists/{{gid}}/tasks"
        hx-vals='{"gid": "{{gid}}", "tid": "{{tid}}", "title": "{{title}}", "desc": "{{desc}}", "date": {{date}}, "done": true, "tags": []}'
        hx-ext="json-enc"
        hx-trigger="click"
      >
      </a>
      {{title}} <small><em>{{tags}}</em></small>
      {{/.}}
    </li>
  </template>
  <ul
    id="tasks-done"
    hx-get="/api/lists/{gid}/tasks"
    hx-vals='{"done": "true"}'
    hx-trigger="load, path-deps"
    path-deps="/apps/maat/api/lists/*/tasks"
    mustache-template="tasks-done-template"
  ></ul>
  <template id="tasks-done-template">
    {{#.}}
    <li>
      <a
        id="{{tid}}"
        class="icon icon-circle-checked"
        hx-put="/api/lists/{{gid}}/tasks"
        hx-vals='{"gid": "{{gid}}", "tid": "{{tid}}", "title": "{{title}}", "desc": "{{desc}}", "date": {{date}}, "done": false, "tags": []}'
        hx-ext="json-enc"
        hx-trigger="click"
      >
      </a>
      {{title}} <small><em>{{tags}}</em></small>
      {{/.}}
    </li>
  </template>
  <!-- <li> -->
  <!--   <a class="icon icon-circle-checked"> </a> -->
  <!--   <s>Cheese</s> -->
  <!-- </li> -->
  <ul class="sticky-bottom">
    <li>
      <a class="icon icon-circle-plus"></a>
      <form
        id="put-tasks"
        class="inline-form"
        hx-put="/api/lists/{gid}/tasks"
        hx-ext="json-enc"
        hx-swap="none"
        hx-vals="js:{tid: self.crypto.randomUUID(), gid: gid(), desc: '', date: new Date().valueOf(), done: false, tags: []}"
        hx-on::after-request="if(event.detail.successful) this.reset();"
      >
        <input
          class="inline-input"
          name="title"
          type="text"
          placeholder="Add new task"
        />
      </form>
    </li>
  </ul>
  <!-- <div class="done"> -->
  <!--   <h3>Done</h3> -->
  <!--   <ul> -->
  <!--     <li> -->
  <!--       <a class="icon icon-circle-checked"> </a> -->
  <!--       Bread -->
  <!--     </li> -->
  <!--     <li> -->
  <!--       <a class="icon icon-circle-checked"> </a> -->
  <!--       Milk -->
  <!--     </li> -->
  <!--     <li> -->
  <!--       <a class="icon icon-circle-checked"> </a> -->
  <!--       Apples -->
  <!--     </li> -->
  <!--     <li> -->
  <!--       <a class="icon icon-circle-checked"> </a> -->
  <!--       Grapefruit -->
  <!--     </li> -->
  <!--     <li> -->
  <!--       <a class="icon icon-circle-checked"> </a> -->
  <!--       Cat food -->
  <!--     </li> -->
  <!--     <li> -->
  <!--       <a class="icon icon-circle-checked"> </a> -->
  <!--       Cheese -->
  <!--     </li> -->
  <!--     <li> -->
  <!--       <a class="icon icon-circle-checked"> </a> -->
  <!--       Wine -->
  <!--     </li> -->
  <!--   </ul> -->
  <!-- </div> -->
  <!-- </main> -->
</div>
</div>
    </div>
    <script src="/apps/maat/helper.js"></script>
  </body>
</html>
